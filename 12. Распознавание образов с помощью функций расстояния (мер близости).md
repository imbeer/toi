## Общая идея метода

Распознавание образов с помощью функций расстояния применяется в рамках **детерминистского (геометрического, метрического) подхода** и основано на предположении, что образы одного класса ближе друг к другу, чем к образам других классов.

Решение о принадлежности образа $x$ принимается на основе сравнения расстояний между $x$ и эталонными образами классов.

## Функция расстояния и метрика

Вещественная неотрицательная функция $d(x_i,x_j)$ называется **метрикой**, если выполняются свойства:

1. $d(x_i,x_i)=0$;
2. $d(x_i,x_j)=d(x_j,x_i)$ (симметрия);
3. $d(x_i,x_j)=0  ⟺  x_i=x_j$​;
4. $d(x_i,x_k)≤d(x_i,x_j)+d(x_j,x_k)$ (неравенство треугольника).

> Если два последних свойства не выполняются, функция называется функцией расстояния, но не является метрикой в строгом смысле.

### Используемые функции расстояния

На практике применяются:

- Евклидово расстояние;
- Расстояние Махаланобиса;
- $l_p$-норма (метрика Минковского).

## Один эталонный образ в каждом классе

Пусть каждый класс $\omega_i$​ представлен одним эталонным образом $z_i$​.

**Решающее правило (минимум расстояния):**

$$ d_E(x, z_i) \le d_E(x, z_j), \quad j \neq i $$

### Евклидово расстояние

$$ d_E(x, z_i) = (x - z_i)^T (x - z_i) $$

Использование квадратов расстояний не меняет решения. Минимизация расстояния эквивалентна выбору максимума функции:

$$ g_i(x) = z_i^T x - \frac{1}{2} z_i^T z_i $$

Введя обозначения:

$$ w_i = z_i, \quad w_{i0} = -\frac{1}{2} z_i^T z_i $$

получаем **линейную разделяющую функцию**:

$$ g_i(x) = w_i^T x + w_{i0} $$

**Геометрический смысл:** Граница решений между двумя классами — гиперплоскость, проходящая через середину отрезка между эталонами и перпендикулярная ему.

## Несколько эталонных образов в каждом классе

Пусть класс $\omega_i​$ представлен множеством эталонов:

$$ Z_i = { z_i^{(1)}, \dots, z_i^{(L)} } $$

**Решающее правило:**

$$ d_E(x, Z_i) = \min_k d_E(x, z_i^{(k)}) $$

Образ относится к тому классу, для которого это расстояние минимально.

При евклидовой метрике правило эквивалентно:

$$ g_i(x) = \max_k \left( z_i^{(k)T} x - \frac{1}{2} z_i^{(k)T} z_i^{(k)} \right) $$

**Геометрический смысл:** Границы областей решений являются геометрическими местами точек, равноудалённых от прямых, соединяющих эталоны различных классов.

## Связь с методом ближайших соседей

Использование одного эталона в каждом классе эквивалентно правилу одного ближайшего соседа. Поэтому алгоритмы метода k-ближайших соседей относятся к **метрическим алгоритмам распознавания**.

## Обучение метрических алгоритмов: STOLP

Эталоны формируются из обучающей выборки путём отбора **опорных образов**.

**Идея STOLP:** оставить такие эталоны, что расстояние от любого образа обучающей выборки до ближайшего эталона _своего_ класса меньше расстояния до ближайшего эталона _чужого_ класса.

### Основные шаги:

1. Для каждого образа вычисляются расстояния до ближайшего образа своего и чужого классов.
2. Вычисляется величина риска:  
   
   $$ W_k(i) = \frac{\rho_k^{\text{out}}}{\rho_k^{\text{in}}} $$
   
1. В качестве эталонов выбираются образы с максимальным риском.
2. Процедура повторяется до безошибочного распознавания обучающей выборки.