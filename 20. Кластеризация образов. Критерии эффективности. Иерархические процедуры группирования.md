![[19. Кластеризация образов. Критерии эффективности. Алгоритм К-средних#Кластеризация образов.]]

![[19. Кластеризация образов. Критерии эффективности. Алгоритм К-средних#Критерии эффективности]]

# Иерархическая кластеризация

> Последовательное объединение(разбиение) групп образов по правилам слияния до М групп.
> Объединение - **агломеративная кластеризация**, при разбиении – **дивизимная.**

На каждом шаге две группы объединяются(агломеративная)
При реализации строят полное дерево вложений - дендрограмму.

**Алгоритм агломеративной кластеризации:**
1. $\tilde{M} = N$, Начальное разбиение $Q_N^1 = \{ X^1, \dots, X^N \}, \quad X^j = x^{(j)}$ 
2. Для выполнения разбиения $Q^k_{N-k+1}$  и $\tilde{M} = N-k+1$ с использованием заданной функции растояния находится  ближайшая пара групп $\min_{i, j} D(X^{N_i}, X^{N_j})$
3. Слияние выбранных групп $X^{N_i + N_j} = X^{N_i} \cup X^{N_j}, \quad \tilde{M} = N - k$
4. Если $\tilde{M} = M$ [остановка]

**Функции расстояния:**
- между ближайшими соседями $D_{NN}(X^{N_i}, X^{N_j}) = \min_{k, s} d(x^{(k,i)}, x^{(s,j)})$
- между самыми удаленными соседями $D_{FN}(X^{N_i}, X^{N_j}) = \max_{k, s} d(x^{(k,i)}, x^{(s,j)})$
- среднее расстояние $D_{BG}(X^{N_i}, X^{N_j}) = \frac{1}{N_i N_j} \sum_{k=1}^{N_i} \sum_{s=1}^{N_j} d(x^{(k,i)}, x^{(s,j)})$
- расстояние между центрами кластеров $D_{BC}(X^{N_i}, X^{N_j}) = d^2(m_i, m_j)$ $m_i = \frac{1}{N_i} \sum_{k=1}^{N_i} x^{(k,i)}, \quad m_j = \frac{1}{N_j} \sum_{s=1}^{N_j} x^{(s,j)}$ 
- расстояние Уорда $D_{WM}(X^{N_i}, X^{N_j}) = \frac{N_i N_j}{N_i + N_j} d^2(m_i, m_j)$